2020-06-24 13:35:29,036: INFO): START
2020-06-24 13:35:29,037: INFO): command line arguments:
chk: null
config: experiments/config_files/embedding_test2.yaml
epochs: 30
log: embedding_test2.log
one_fold: false
permute: null

2020-06-24 13:35:29,042: INFO): Config:
loader_config:
  checkpoint: embedding1_chk.pkz
  descriptors:
  - ecfp6
  file: rr_processed_data_sml_all_morgan_rdkit.pkz
  inputs:
  - halogen
  - boronic
  - solvent
  - base
  - ligand
  output: yield
model_config:
  act1: relu
  act2: relu
  batchnorm: true
  dropout: 0.2
  hidden1: 64
  hidden2: 128
  inter_act: linear
  inter_hidden: 10
  inter_idx:
  - - 0
    - 1
  - - 2
    - 3
    - 4
  inter_layers: 1
  l2val: 0.001
  loss: mse
  merge: mult
  n_layers1: 1
  n_layers2: 1
  out_act: linear
  standarization: normal
train_config:
  batch_size: 100
  epochs: 30
  verbose: true

2020-06-24 13:35:29,042: INFO): using checkpoint: embedding1_chk.pkz
2020-06-24 13:35:29,791: INFO): checkpoint loaded
2020-06-24 13:35:30,385: INFO): Constant cols eliminated
2020-06-24 13:35:30,386: INFO): data shapes: [(17526, 512), (17526, 512), (17526, 181), (17526, 47), (17526, 505)]
2020-06-24 13:35:30,386: INFO): Normal standarization of Y
2020-06-24 13:35:30,386: INFO): Fold 0
2020-06-24 13:35:30,951: INFO): Model info:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 512)          0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 512)          0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 181)          0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 47)           0                                            
__________________________________________________________________________________________________
input_5 (InputLayer)            (None, 505)          0                                            
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 64)           32832       input_1[0][0]                    
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 64)           32832       input_2[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 64)           11648       input_3[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 64)           3072        input_4[0][0]                    
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 64)           32384       input_5[0][0]                    
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 64)           0           dense_1[0][0]                    
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 64)           0           dense_2[0][0]                    
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 64)           0           dense_3[0][0]                    
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 64)           0           dense_4[0][0]                    
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 64)           0           dense_5[0][0]                    
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 64)           256         dropout_1[0][0]                  
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 64)           256         dropout_2[0][0]                  
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 64)           256         dropout_3[0][0]                  
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 64)           256         dropout_4[0][0]                  
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 64)           256         dropout_5[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 128)          0           batch_normalization_1[0][0]      
                                                                 batch_normalization_2[0][0]      
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 192)          0           batch_normalization_3[0][0]      
                                                                 batch_normalization_4[0][0]      
                                                                 batch_normalization_5[0][0]      
__________________________________________________________________________________________________
dense_6 (Dense)                 (None, 10)           1290        concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_7 (Dense)                 (None, 10)           1930        concatenate_2[0][0]              
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 10)           0           dense_6[0][0]                    
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 10)           0           dense_7[0][0]                    
__________________________________________________________________________________________________
batch_normalization_6 (BatchNor (None, 10)           40          dropout_6[0][0]                  
__________________________________________________________________________________________________
batch_normalization_7 (BatchNor (None, 10)           40          dropout_7[0][0]                  
__________________________________________________________________________________________________
multiply_1 (Multiply)           (None, 10)           0           batch_normalization_6[0][0]      
                                                                 batch_normalization_7[0][0]      
__________________________________________________________________________________________________
dense_8 (Dense)                 (None, 128)          1408        multiply_1[0][0]                 
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 128)          0           dense_8[0][0]                    
__________________________________________________________________________________________________
batch_normalization_8 (BatchNor (None, 128)          512         dropout_8[0][0]                  
__________________________________________________________________________________________________
dense_9 (Dense)                 (None, 1)            129         batch_normalization_8[0][0]      
==================================================================================================
Total params: 119,397
Trainable params: 118,461
Non-trainable params: 936
__________________________________________________________________________________________________
2020-06-24 13:35:51,062: INFO): Fold 1
2020-06-24 13:35:51,671: INFO): Model info:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_6 (InputLayer)            (None, 512)          0                                            
__________________________________________________________________________________________________
input_7 (InputLayer)            (None, 512)          0                                            
__________________________________________________________________________________________________
input_8 (InputLayer)            (None, 181)          0                                            
__________________________________________________________________________________________________
input_9 (InputLayer)            (None, 47)           0                                            
__________________________________________________________________________________________________
input_10 (InputLayer)           (None, 505)          0                                            
__________________________________________________________________________________________________
dense_10 (Dense)                (None, 64)           32832       input_6[0][0]                    
__________________________________________________________________________________________________
dense_11 (Dense)                (None, 64)           32832       input_7[0][0]                    
__________________________________________________________________________________________________
dense_12 (Dense)                (None, 64)           11648       input_8[0][0]                    
__________________________________________________________________________________________________
dense_13 (Dense)                (None, 64)           3072        input_9[0][0]                    
__________________________________________________________________________________________________
dense_14 (Dense)                (None, 64)           32384       input_10[0][0]                   
__________________________________________________________________________________________________
dropout_9 (Dropout)             (None, 64)           0           dense_10[0][0]                   
__________________________________________________________________________________________________
dropout_10 (Dropout)            (None, 64)           0           dense_11[0][0]                   
__________________________________________________________________________________________________
dropout_11 (Dropout)            (None, 64)           0           dense_12[0][0]                   
__________________________________________________________________________________________________
dropout_12 (Dropout)            (None, 64)           0           dense_13[0][0]                   
__________________________________________________________________________________________________
dropout_13 (Dropout)            (None, 64)           0           dense_14[0][0]                   
__________________________________________________________________________________________________
batch_normalization_9 (BatchNor (None, 64)           256         dropout_9[0][0]                  
__________________________________________________________________________________________________
batch_normalization_10 (BatchNo (None, 64)           256         dropout_10[0][0]                 
__________________________________________________________________________________________________
batch_normalization_11 (BatchNo (None, 64)           256         dropout_11[0][0]                 
__________________________________________________________________________________________________
batch_normalization_12 (BatchNo (None, 64)           256         dropout_12[0][0]                 
__________________________________________________________________________________________________
batch_normalization_13 (BatchNo (None, 64)           256         dropout_13[0][0]                 
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 128)          0           batch_normalization_9[0][0]      
                                                                 batch_normalization_10[0][0]     
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 192)          0           batch_normalization_11[0][0]     
                                                                 batch_normalization_12[0][0]     
                                                                 batch_normalization_13[0][0]     
__________________________________________________________________________________________________
dense_15 (Dense)                (None, 10)           1290        concatenate_3[0][0]              
__________________________________________________________________________________________________
dense_16 (Dense)                (None, 10)           1930        concatenate_4[0][0]              
__________________________________________________________________________________________________
dropout_14 (Dropout)            (None, 10)           0           dense_15[0][0]                   
__________________________________________________________________________________________________
dropout_15 (Dropout)            (None, 10)           0           dense_16[0][0]                   
__________________________________________________________________________________________________
batch_normalization_14 (BatchNo (None, 10)           40          dropout_14[0][0]                 
__________________________________________________________________________________________________
batch_normalization_15 (BatchNo (None, 10)           40          dropout_15[0][0]                 
__________________________________________________________________________________________________
multiply_2 (Multiply)           (None, 10)           0           batch_normalization_14[0][0]     
                                                                 batch_normalization_15[0][0]     
__________________________________________________________________________________________________
dense_17 (Dense)                (None, 128)          1408        multiply_2[0][0]                 
__________________________________________________________________________________________________
dropout_16 (Dropout)            (None, 128)          0           dense_17[0][0]                   
__________________________________________________________________________________________________
batch_normalization_16 (BatchNo (None, 128)          512         dropout_16[0][0]                 
__________________________________________________________________________________________________
dense_18 (Dense)                (None, 1)            129         batch_normalization_16[0][0]     
==================================================================================================
Total params: 119,397
Trainable params: 118,461
Non-trainable params: 936
__________________________________________________________________________________________________
2020-06-24 13:36:12,476: INFO): Fold 2
2020-06-24 13:36:13,092: INFO): Model info:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_11 (InputLayer)           (None, 512)          0                                            
__________________________________________________________________________________________________
input_12 (InputLayer)           (None, 512)          0                                            
__________________________________________________________________________________________________
input_13 (InputLayer)           (None, 181)          0                                            
__________________________________________________________________________________________________
input_14 (InputLayer)           (None, 47)           0                                            
__________________________________________________________________________________________________
input_15 (InputLayer)           (None, 505)          0                                            
__________________________________________________________________________________________________
dense_19 (Dense)                (None, 64)           32832       input_11[0][0]                   
__________________________________________________________________________________________________
dense_20 (Dense)                (None, 64)           32832       input_12[0][0]                   
__________________________________________________________________________________________________
dense_21 (Dense)                (None, 64)           11648       input_13[0][0]                   
__________________________________________________________________________________________________
dense_22 (Dense)                (None, 64)           3072        input_14[0][0]                   
__________________________________________________________________________________________________
dense_23 (Dense)                (None, 64)           32384       input_15[0][0]                   
__________________________________________________________________________________________________
dropout_17 (Dropout)            (None, 64)           0           dense_19[0][0]                   
__________________________________________________________________________________________________
dropout_18 (Dropout)            (None, 64)           0           dense_20[0][0]                   
__________________________________________________________________________________________________
dropout_19 (Dropout)            (None, 64)           0           dense_21[0][0]                   
__________________________________________________________________________________________________
dropout_20 (Dropout)            (None, 64)           0           dense_22[0][0]                   
__________________________________________________________________________________________________
dropout_21 (Dropout)            (None, 64)           0           dense_23[0][0]                   
__________________________________________________________________________________________________
batch_normalization_17 (BatchNo (None, 64)           256         dropout_17[0][0]                 
__________________________________________________________________________________________________
batch_normalization_18 (BatchNo (None, 64)           256         dropout_18[0][0]                 
__________________________________________________________________________________________________
batch_normalization_19 (BatchNo (None, 64)           256         dropout_19[0][0]                 
__________________________________________________________________________________________________
batch_normalization_20 (BatchNo (None, 64)           256         dropout_20[0][0]                 
__________________________________________________________________________________________________
batch_normalization_21 (BatchNo (None, 64)           256         dropout_21[0][0]                 
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 128)          0           batch_normalization_17[0][0]     
                                                                 batch_normalization_18[0][0]     
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 192)          0           batch_normalization_19[0][0]     
                                                                 batch_normalization_20[0][0]     
                                                                 batch_normalization_21[0][0]     
__________________________________________________________________________________________________
dense_24 (Dense)                (None, 10)           1290        concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_25 (Dense)                (None, 10)           1930        concatenate_6[0][0]              
__________________________________________________________________________________________________
dropout_22 (Dropout)            (None, 10)           0           dense_24[0][0]                   
__________________________________________________________________________________________________
dropout_23 (Dropout)            (None, 10)           0           dense_25[0][0]                   
__________________________________________________________________________________________________
batch_normalization_22 (BatchNo (None, 10)           40          dropout_22[0][0]                 
__________________________________________________________________________________________________
batch_normalization_23 (BatchNo (None, 10)           40          dropout_23[0][0]                 
__________________________________________________________________________________________________
multiply_3 (Multiply)           (None, 10)           0           batch_normalization_22[0][0]     
                                                                 batch_normalization_23[0][0]     
__________________________________________________________________________________________________
dense_26 (Dense)                (None, 128)          1408        multiply_3[0][0]                 
__________________________________________________________________________________________________
dropout_24 (Dropout)            (None, 128)          0           dense_26[0][0]                   
__________________________________________________________________________________________________
batch_normalization_24 (BatchNo (None, 128)          512         dropout_24[0][0]                 
__________________________________________________________________________________________________
dense_27 (Dense)                (None, 1)            129         batch_normalization_24[0][0]     
==================================================================================================
Total params: 119,397
Trainable params: 118,461
Non-trainable params: 936
__________________________________________________________________________________________________
2020-06-24 13:36:34,460: INFO): Fold 3
2020-06-24 13:36:35,043: INFO): Model info:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_16 (InputLayer)           (None, 512)          0                                            
__________________________________________________________________________________________________
input_17 (InputLayer)           (None, 512)          0                                            
__________________________________________________________________________________________________
input_18 (InputLayer)           (None, 181)          0                                            
__________________________________________________________________________________________________
input_19 (InputLayer)           (None, 47)           0                                            
__________________________________________________________________________________________________
input_20 (InputLayer)           (None, 505)          0                                            
__________________________________________________________________________________________________
dense_28 (Dense)                (None, 64)           32832       input_16[0][0]                   
__________________________________________________________________________________________________
dense_29 (Dense)                (None, 64)           32832       input_17[0][0]                   
__________________________________________________________________________________________________
dense_30 (Dense)                (None, 64)           11648       input_18[0][0]                   
__________________________________________________________________________________________________
dense_31 (Dense)                (None, 64)           3072        input_19[0][0]                   
__________________________________________________________________________________________________
dense_32 (Dense)                (None, 64)           32384       input_20[0][0]                   
__________________________________________________________________________________________________
dropout_25 (Dropout)            (None, 64)           0           dense_28[0][0]                   
__________________________________________________________________________________________________
dropout_26 (Dropout)            (None, 64)           0           dense_29[0][0]                   
__________________________________________________________________________________________________
dropout_27 (Dropout)            (None, 64)           0           dense_30[0][0]                   
__________________________________________________________________________________________________
dropout_28 (Dropout)            (None, 64)           0           dense_31[0][0]                   
__________________________________________________________________________________________________
dropout_29 (Dropout)            (None, 64)           0           dense_32[0][0]                   
__________________________________________________________________________________________________
batch_normalization_25 (BatchNo (None, 64)           256         dropout_25[0][0]                 
__________________________________________________________________________________________________
batch_normalization_26 (BatchNo (None, 64)           256         dropout_26[0][0]                 
__________________________________________________________________________________________________
batch_normalization_27 (BatchNo (None, 64)           256         dropout_27[0][0]                 
__________________________________________________________________________________________________
batch_normalization_28 (BatchNo (None, 64)           256         dropout_28[0][0]                 
__________________________________________________________________________________________________
batch_normalization_29 (BatchNo (None, 64)           256         dropout_29[0][0]                 
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 128)          0           batch_normalization_25[0][0]     
                                                                 batch_normalization_26[0][0]     
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 192)          0           batch_normalization_27[0][0]     
                                                                 batch_normalization_28[0][0]     
                                                                 batch_normalization_29[0][0]     
__________________________________________________________________________________________________
dense_33 (Dense)                (None, 10)           1290        concatenate_7[0][0]              
__________________________________________________________________________________________________
dense_34 (Dense)                (None, 10)           1930        concatenate_8[0][0]              
__________________________________________________________________________________________________
dropout_30 (Dropout)            (None, 10)           0           dense_33[0][0]                   
__________________________________________________________________________________________________
dropout_31 (Dropout)            (None, 10)           0           dense_34[0][0]                   
__________________________________________________________________________________________________
batch_normalization_30 (BatchNo (None, 10)           40          dropout_30[0][0]                 
__________________________________________________________________________________________________
batch_normalization_31 (BatchNo (None, 10)           40          dropout_31[0][0]                 
__________________________________________________________________________________________________
multiply_4 (Multiply)           (None, 10)           0           batch_normalization_30[0][0]     
                                                                 batch_normalization_31[0][0]     
__________________________________________________________________________________________________
dense_35 (Dense)                (None, 128)          1408        multiply_4[0][0]                 
__________________________________________________________________________________________________
dropout_32 (Dropout)            (None, 128)          0           dense_35[0][0]                   
__________________________________________________________________________________________________
batch_normalization_32 (BatchNo (None, 128)          512         dropout_32[0][0]                 
__________________________________________________________________________________________________
dense_36 (Dense)                (None, 1)            129         batch_normalization_32[0][0]     
==================================================================================================
Total params: 119,397
Trainable params: 118,461
Non-trainable params: 936
__________________________________________________________________________________________________
2020-06-24 13:36:57,023: INFO): Fold 4
2020-06-24 13:36:57,615: INFO): Model info:
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_21 (InputLayer)           (None, 512)          0                                            
__________________________________________________________________________________________________
input_22 (InputLayer)           (None, 512)          0                                            
__________________________________________________________________________________________________
input_23 (InputLayer)           (None, 181)          0                                            
__________________________________________________________________________________________________
input_24 (InputLayer)           (None, 47)           0                                            
__________________________________________________________________________________________________
input_25 (InputLayer)           (None, 505)          0                                            
__________________________________________________________________________________________________
dense_37 (Dense)                (None, 64)           32832       input_21[0][0]                   
__________________________________________________________________________________________________
dense_38 (Dense)                (None, 64)           32832       input_22[0][0]                   
__________________________________________________________________________________________________
dense_39 (Dense)                (None, 64)           11648       input_23[0][0]                   
__________________________________________________________________________________________________
dense_40 (Dense)                (None, 64)           3072        input_24[0][0]                   
__________________________________________________________________________________________________
dense_41 (Dense)                (None, 64)           32384       input_25[0][0]                   
__________________________________________________________________________________________________
dropout_33 (Dropout)            (None, 64)           0           dense_37[0][0]                   
__________________________________________________________________________________________________
dropout_34 (Dropout)            (None, 64)           0           dense_38[0][0]                   
__________________________________________________________________________________________________
dropout_35 (Dropout)            (None, 64)           0           dense_39[0][0]                   
__________________________________________________________________________________________________
dropout_36 (Dropout)            (None, 64)           0           dense_40[0][0]                   
__________________________________________________________________________________________________
dropout_37 (Dropout)            (None, 64)           0           dense_41[0][0]                   
__________________________________________________________________________________________________
batch_normalization_33 (BatchNo (None, 64)           256         dropout_33[0][0]                 
__________________________________________________________________________________________________
batch_normalization_34 (BatchNo (None, 64)           256         dropout_34[0][0]                 
__________________________________________________________________________________________________
batch_normalization_35 (BatchNo (None, 64)           256         dropout_35[0][0]                 
__________________________________________________________________________________________________
batch_normalization_36 (BatchNo (None, 64)           256         dropout_36[0][0]                 
__________________________________________________________________________________________________
batch_normalization_37 (BatchNo (None, 64)           256         dropout_37[0][0]                 
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 128)          0           batch_normalization_33[0][0]     
                                                                 batch_normalization_34[0][0]     
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 192)          0           batch_normalization_35[0][0]     
                                                                 batch_normalization_36[0][0]     
                                                                 batch_normalization_37[0][0]     
__________________________________________________________________________________________________
dense_42 (Dense)                (None, 10)           1290        concatenate_9[0][0]              
__________________________________________________________________________________________________
dense_43 (Dense)                (None, 10)           1930        concatenate_10[0][0]             
__________________________________________________________________________________________________
dropout_38 (Dropout)            (None, 10)           0           dense_42[0][0]                   
__________________________________________________________________________________________________
dropout_39 (Dropout)            (None, 10)           0           dense_43[0][0]                   
__________________________________________________________________________________________________
batch_normalization_38 (BatchNo (None, 10)           40          dropout_38[0][0]                 
__________________________________________________________________________________________________
batch_normalization_39 (BatchNo (None, 10)           40          dropout_39[0][0]                 
__________________________________________________________________________________________________
multiply_5 (Multiply)           (None, 10)           0           batch_normalization_38[0][0]     
                                                                 batch_normalization_39[0][0]     
__________________________________________________________________________________________________
dense_44 (Dense)                (None, 128)          1408        multiply_5[0][0]                 
__________________________________________________________________________________________________
dropout_40 (Dropout)            (None, 128)          0           dense_44[0][0]                   
__________________________________________________________________________________________________
batch_normalization_40 (BatchNo (None, 128)          512         dropout_40[0][0]                 
__________________________________________________________________________________________________
dense_45 (Dense)                (None, 1)            129         batch_normalization_40[0][0]     
==================================================================================================
Total params: 119,397
Trainable params: 118,461
Non-trainable params: 936
__________________________________________________________________________________________________
2020-06-24 13:37:20,526: INFO): Transfroming mse to rmse, back transformation to Y space
2020-06-24 13:37:20,526: INFO): MAE:   16.152 (   1.715)
2020-06-24 13:37:20,538: INFO): Best epoch: 23
2020-06-24 13:37:20,538: INFO): CV AV:   22.294
2020-06-24 13:37:20,538: INFO): CV std    1.960
